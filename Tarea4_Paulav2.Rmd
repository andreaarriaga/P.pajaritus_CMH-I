//////////---
title: "Tarea4"
author: "Paula Iturralde-PÃ³lit"
date: "04/11/2020"
output: html_document
---



```{r}

require(lme4)
require(nlme)
require(ggplot2)

```




























































































```{r setup, echo=TRUE}


datos <- read.csv("C:/Users/pmiturralde/Documents/Paula_mi_bitacora/Doctorado_UCR/Cursos/Ciencia_Rep/Tareas/Tarea4/Datos_tarea4.csv",header=T,sep=",")

View(datos)


```

```{r}


require(ggdag)

dagified <- dagify(D ~ H,
                   D ~ L,
                   H ~ L,
                   exposure = "H",
                   outcome = "D")

ggdag(dagified, layout = "circle") + theme_dag()


```

```{r}

tidy_dagitty(dagified)

```

## Visualizar datos

Relacion entre los tipos de degradacion de habitat y la diversidad de alelos

```{r}
#Visualize data


colnames(datos)


D = ggplot() + 
  geom_point(data = datos, aes(D, H1), color = "brown3")+
  geom_point(data = datos, aes(D, H2), color = "darkgreen")+
  geom_point(data = datos, aes(D, H3), color = "cyan4")+
  geom_point(data = datos, aes(D, H4), color = "coral1")+
  geom_point(data = datos, aes(D, H5), color = "darkorange1")+
  labs(y="Tipos de Degradacion", x="Diversidad de alelos") +
    theme_bw()

D



```

Relacion entre la latitud y la degradacion del habitat


```{r}



L = ggplot() + 
  geom_point(data = datos, aes(H1, L), color = "brown3", size = 3, pch = 17)+
  geom_point(data = datos, aes(H2, L), color = "darkgreen", size = 3, pch = 17)+
  geom_point(data = datos, aes(H3, L), color = "cyan4", size = 3, pch = 17)+
  geom_point(data = datos, aes(H4, L), color = "coral1", size = 3, pch = 17)+
  geom_point(data = datos, aes(H5, L), color = "darkorange1", size = 3, pch = 17)+
  labs(y="Latitud", x="Tipos de degradacion del Habitat") +
    theme_bw()

L



```

Relacion entre la DIversidad de Alelos y la latitud

```{r}


ggplot() + 
geom_point(data = datos, aes(y = L, x = D), fill = "chocolate1", color = "black", size = 3, pch = 23)+
labs(y="Latitud", x="Diversidad de Alelos") +
    theme_bw()
  


```

## Grafico de battas: frecuencia de diversidad

```{r}


ggplot() + 
geom_bar(data = datos, aes(D), fill = "darkblue")+
  labs(y="Frecuencia", x="Diversidad de Alelos") +
    theme_bw()



```

## Correccion de modelos

### Modelo 2

En el modelo anterior se plantea varios modelos controlando por todas las variables H (de H1 a H5) por separado. Esto puede generar un error por comparaciones indirectas que puede resultar en un analisis equivocado de como se diferencian las variables entre si.


Para corregir este error se plantea ahora un modelo en el que se controle por todas las variables H. Tambien se controla por la variable de la latitud ya que ambas tienen un efecto sobre la diversidad de alelos. 


```{r}

#Modelos
#todas las variables sin tomar en cuenta a P como un factor aleatorio (podria ser el correcto)
M.2 <- lm(D ~ H1 + H2 + H3 + H4 + H5 + L, data = datos)
summary(M.2)


```


```{r}

m3 <- lmer(D ~ H1 + H2 + H3 + H4 + H5 + L + (1|P), data = datos)
summary(m3)


m3.1 <- lmer(D ~ H1 + L + (1|P), data = datos)
summary(m3.1)

m3.2 <- lmer(D ~ H2 + L + (1|P), data = datos)
summary(m3.2)

m3.3 <- lmer(D ~ H3 + L + (1|P), data = datos)
summary(m3.3)

m3.4 <- lmer(D ~ H4 + L + (1|P), data = datos)
summary(m3.4)

m3.5 <- lmer(D ~ H5 + L + (1|P), data = datos)
summary(m3.5)




```


```{r}


m6 <- lm(D ~ L + H1+ H2 + H3 + H4 + H5 + P + factor(A), data = dat)
summary(m6)



```




